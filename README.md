<img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Tetrahedron-4-3D-balls.png" align="right" width="150" height="150" />

# Simplex  

Python source code for studying the simultaneous emergence of ecological patterns.

## Purpose  
**Simplex** performs three tasks:

1. Builds and runs individual-based ecological models based on dynamics of selection, stochasticity, and energetics.

2. Quantifies and records individual-to-ecosystem level information across time steps and models.

3. Provides quantitative and graphical tools for analysis of ecological patterns and relationships.

## The ODD protocol
Grimm *et al* (2006) developed a protocol known as the ODD as a standard for describing individual-based models (IBMs).
Because **simplex** is a platform for IBMs and not simply a model, we descibe **simplex** as close as reasonable according to the ODD. 
See SimplexPrePrint.md file located in the manuscript directory.
The user should note that the ODD was not intended for describing software.

Grimm, V. *et al*. (2006) A standard protocol for describing individual-based and agent-based models. Ecological Modeling. **198,** 115-126. *not OA*


## Suggested software
Simplex was developed on the Enthought Canopy Python distribution (version 1.5.5) available here: https://store.enthought.com/

Simplex implements unit testing using pytest version 2.8.1; see: http://pytest.org/latest/getting-started.html#getstarted

Simplex output can be imported into Python and R environments as dataframes.
R scripts are provided in the tools/Rcode folder.
For this reason, the R friendly user may want to install RStudio: https://www.rstudio.com/products/rstudio/download/ and/or R: https://www.r-project.org/

A free preprint version of the Simplex manuscript is generated using Pandoc version 1.15.0.6.: http://pandoc.org/installing.html

## Files & Directories
The following are general descriptions. For greater detail of the contents of various directories, see the info.md files located in each directory or the comments in the source code.

**License:** An MIT license stating the conditions under which Simplex is freely provided.

**SimplexPrePrint.md:** A markdown version of the Simplex manuscript.

**SimplexPrePrint.pdf:** A pdf version of the Simplex manuscript.
This pdf is generated with Pandoc version 1.15.0.6, using the command:  

	~/GitHub/simplex/SimplexPrePrint.md --latex-engine=xelatex -o ~/GitHub/simplex/SimplexPrePrint.pdf

**Directory: results**

* Sub-directory: figures -- Contains files for figures resulting from user analyses. Also contains a folder of example figures.

* Sub-directory: simulated_data -- Contains files generated by Simplex models.

* Sub-directory: movies -- Contains example animations of Simplex models.

**Directory: model**

* main.py: This is the primary file for running simplex. 
Once run, Simplex begins assembling and running simulation models. Output for the numbers of models run and additional cursory data are printed to the users terminal window.

* Sub-directory: spatial_functions -- Contains a file for calculating distances and examining species-area relationships.

* Sub-directory: processes -- Contains files for simulating active dispersal, consumption, disturbance, growth, immigration, basal metabolism, passive dispersal, reproduction, resource flow and resource inflow, speciation, and transitions between metabolically active and dormant physiological states.

* Sub-directory: input_output -- Contains a file (labels.py) used for modifying and importing data labels and a file (output.py) used for writing simulation data to the SimData.csv, RAD.csv, and SAR.csv files.

* Sub-directory: fluid_dynamics -- Contains code for simulating computational fluid dynamics

* Sub-directory: diversity_metrics -- Contains code for quantifying multiple aspects of local scale diversity and temporal changes in diversity.


**Directory: tools**

* Sub-directory: DiversityTools -- Contains code for obtaining predicted species abundance distributions. This directory contains an info.md file.

* Sub-directory: Rcode -- Contains R scipts for analysis of simulation data.

* Sub-directory: SADfits -- Contains python code for fitting species abundance distributions to simulation data 

* Sub-directory: unit_tests -- Contains python code for testing metrics of diversity, spatial statistics, the operation of simulation processes (e.g., reproduction), and the writing of data to output files.


## Unit tests
Source code for unit testing, available in the **tools/unit_tests** directory.
The following unit testing is currently implemented on:

* Spatial statistics
* Diversity metrics
* Generation of figures and data
* Functions that simulate ecological processes

## Complete Directory Tree
```
Simplex
│   README.md
│   LICENSE    
│
└───figure_code
│   │   file011.txt
│   │   file012.txt
│   │
│   └───MacroecologyPatterns
│   │      DiversityAbundanceScaling.py
|   |      MetabolicScaling.py
|   |      SAR.py
|   |      TaylorsLaw.py
|   |
│   └───ResourcePatterns
│   |      Res_vs_Tau.py 
|   |
│   └───TaxaDiversityPatterns
│   |      Taxa_vs_Tau.py
|   |
|   └───TraitDiversityPatterns
│          Trait_vs_Tau.py 
|   
└───model
|   |   main.py
|   |
│   └───SpatialFunctions
│   |      spatial.py 
|   |
│   └───Processes
│   |      processes.py
|   |
|   └───InputOutput
│   |      labels.py
|   |      output.py
|   |
|   └───FluidDynamics
│   |      lbm.py
|   |
|   └───DiversityMetrics
│          metrics.py   
|
└───manuscript
│   │   SimplexPrePrint.md
│   
└───results
│   └───figures
|   |   └───examples
|   |   |       DiversityAbundanceScaling.png
|   |   |       MetabolicScaling.png
|   |   |       resources_tau.png
|   |   |       SAR.png
|   |   |       Taxa_vs_Tau.png
|   |   |       TaylorsLaw.png
|   |   |       Traits_vs_Tau.png
|   |   |
│   │   └───simulated_data
|   |   |   └───examples
|   |   |          SimData.csv
|   |   |          SARData.csv
|   |   |          RADData.csv

```