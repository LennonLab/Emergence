<img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Tetrahedron-4-3D-balls.png" align="right" width="150" height="150" />

# simplex  

Source code for studying the simultaneous emergence of ecological relationships.

### Purpose  
**Simplex** performs three tasks:

1. Builds and runs individual-based ecological models based on dynamics of selection, stochasticity, and energetics.

2. Quantifies and records individual-to-ecosystem level information across time steps and models.

3. Provides quantitative and graphical tools for analysis of ecological patterns and relationships.

## Suggested software
**Simplex** was developed on the free Enthought Canopy Python distribution (version 1.5.5) available here: https://store.enthought.com/

**Simplex** implements unit testing using pytest version 2.8.1; see: http://pytest.org/latest/getting-started.html#getstarted

## Files & Directories
Sub-directories can have python bytecode (.pyc) files.
Python generates these files automatically when a .py file is called as a module.
These files are not run by individual users.

**Directory: results**

* Sub-directory: figures -- Contains files for figures resulting from user analyses. Also contains a folder of example figures.

* Sub-directory: simulated_data -- Contains files generated by Simplex models.

* Sub-directory: movies -- Contains example animations of Simplex models.

**Directory: model**

* main.py: This is the primary file for running simplex. 
Once run, Simplex begins assembling and running simulation models. Output for the numbers of models run and additional cursory data are printed to the users terminal window.

* Sub-directory: spatial_functions -- Contains a file for calculating distances and examining species-area relationships.

* Sub-directory: processes -- Contains files for simulating active dispersal, consumption, disturbance, growth, immigration, basal metabolism, passive dispersal, reproduction, resource flow and resource inflow, speciation, and transitions between metabolically active and dormant physiological states.

* Sub-directory: input_output -- Contains a file (labels.py) used for modifying and importing data labels and a file (output.py) used for writing simulation data to the SimData.csv, RAD.csv, and SAR.csv files.

* Sub-directory: fluid_dynamics -- Contains code for simulating computational fluid dynamics

* Sub-directory: diversity_metrics -- Contains code for quantifying multiple aspects of local scale diversity and temporal changes in diversity.


**Directory: tools**  
**Sub-directory: BIDE**  
*bide.py*: This python file contains functions for simulating birth, immigration, dispersal, growth, consumption, maintanence, reproduction, predation, disturbance, searching, among others.

**Sub-directory: LBM**  
*LBM.py*: This python file contains functions for simulating a 2D fluid dynamic environment.

**Sub-directory: metrics**  
*metrics.py*: Includes 28 metrics of species richness, diversity, and evenness.
Also includes functions for generating kernel density curves and calculating total simulated productivity.

**Sub-directory: randparams**  
*randparams.py*: contains just a single but large function for generating random values for state variables.

**Sub-directory: Rbin**  
*metrics.R*: At the moment, only contains functions for finding species richness and for calculating species turnover.

*multiplot.R*: Contains R code to generate a nice looking multi-plot with or without a black theme in ggplot2

**Sub-directory: unit_tests**  
*test_metrics.py*: Unit tests for biodiversity metrics in metrics.py
  
*test_bide.py*: Incomplete code for testing functions in bide.py  

*test_ListToIndex.py*: Currently unimplemented code for testing that 1D vector coordinates map to and from a 2D grid.  

*\_\_pycache__*: When you run a program in python, the interpreter compiles it to bytecode and stores it in the __pycache__ folder. Just ignore it as it makes your program start a little faster. When your scripts change, they will be recompiled, and if you delete the files or the whole and run your program again, they will reappear (unless you specifically suppress that behavior).

see: http://stackoverflow.com/questions/16869024/what-is-pycache

## Unit tests
Source code for unit testing, available in the **tools/unit_tests** directory.
The following unit testing is currently implemented on:

* Spatial statistics
* Diversity metrics
* Generation of figures and data
* Functions that simulate ecological processes

## The ODD protocol
The ODD protocol is an accepted standard for describing individual-based models.
We descibe **simplex** as close as reasonable according to an ODD protocol.

Grimm, V. *et al*. (2006) A standard protocol for describing individual-based and agent-based models. Ecological Modeling. **198,** 115-126. *not OA*





## Using simulated data in R
Though coded in Python (and sometimes in Cython for speed), the output of **simplex** can be imported into Python and R environments as dataframes. R Markdown scripts are provided in the analyses folder.