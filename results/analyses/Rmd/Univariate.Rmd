---
title: "Univariate analyses of simplex output"
author: "Ken Locey"
date: "October, 2015"
header-includes:
   - \usepackage{array}
output: pdf_document
geometry: margin=2.54cm
---

## OVERVEW

This R Markdown document is designed to be opened and ran in the RStudio. The chunks of code below allow for univariate (i.e., x vs. y) relationships between variable in the output of **simplex** models.

## SETUP
## A. Clear and set the working directory

```{r, results = 'hide', echo=TRUE, message = FALSE, warning = FALSE}
rm(list=ls()) 
getwd() 
setwd("~/GitHub/simplex") 
```


## B. Import packages; install if needed

```{r, results = 'hide', echo=TRUE, message = FALSE, warning = FALSE}
#install.packages("vegan") 
require("vegan") 
library(ggplot2)
```


## C. Import custom modules of R functions

```{r, results = 'hide', echo=TRUE, message = FALSE, warning = FALSE}
## Loading files with plotting and diversity functions
source("~/GitHub/simplex/tools/Rbin/metrics.R")
```


## D. Import simulated data generated by simplex models

As it is iterating through randomly assembled models, simplex writes its output to six .csv files. For each file, each row corresponds to a single model. Consequently, the *i*th row in each file corresponds to *i*th model that was assembled and run by simplex.
Let's import the simulated data files.

```{r, results = 'hide', echo=TRUE, message = FALSE, warning = FALSE}

# 1. A table where each columns corresponds to a state variable or model output.  
dat <- read.csv("~/GitHub/simplex/results/simulated_data/examples/SimData.csv")

# 2. Three files where each element of a given row corresponds to the amount of time an
# individual spent in the system.
ind.rtds <- get.vectors("~/GitHub/simplex/results/simulated_data/examples/IndRTD.csv")
res.rtds <- get.vectors("~/GitHub/simplex/results/simulated_data/examples/ResRTD.csv")
tracer.rtds <- get.vectors("~/GitHub/simplex/results/simulated_data/examples/TracerRTD.csv")

species.list <- get.vectors("~/GitHub/simplex/results/simulated_data/examples/Species.csv")

rads <- get.vectors("~/GitHub/simplex/results/simulated_data/examples/RADs.csv")
```


## UNIVARIATE ANALYSES

## 1.) Does simplex produce realistic univariate relationships?
Let's begin by asking how species richness (*S*) and species evenness relate to total abundance (*N*). Usually, we would expect to find greater numbers of species when sampling greater numbers of individuals, i.e., a positive relationship between *N* and *S*. Do simplex models generally conform to this simple prediction? What other simple or straightforward relationships should we expect to find?

```{r, results = 'hide', echo=TRUE, message = FALSE, warning = FALSE, fig.width=7, fig.height=4}
N <- dat$total.abundance[dat$total.abundance<=0] <- 1
S <- dat$species.richness[dat$species.richness<=0] <- 1

ggplot(dat, aes(x=dat$total.abundance, y=dat$species.richness)) +
  geom_point(colour="blue") +
  scale_x_log10() +
  scale_y_log10() +
  labs(x= "Total abundance", y="Species richness")
```

## 2.) Graphical exploration: What lesser known relationships does simplex suggest we should observe?
We might also expect to find that species evenness decreases with *N*, i.e., larger ecological communities have a less equitable distribution of abundance. Do simplex models produce these relationships?

```{r, results = 'hide', echo=TRUE, message = FALSE, warning = FALSE, fig.width=7, fig.height=4}

ggplot(dat, aes(x=dat$total.abundance, y=dat$e.var)) +
  geom_point(colour="red") +
  scale_x_log10() +
  scale_y_log10() +
  labs(x= "Total abundance", y="Species evenness")
```
